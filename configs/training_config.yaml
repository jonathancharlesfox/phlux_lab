client_name: "ClientA"

# ============================================================
# Model config
# ============================================================
model:
  type: "ann"
  nodes_layers: [64, 64, 64]
  activation: "relu"
  learning_rate: 0.0001
  epochs: 150
  batch_size: 128
  earlystop: true
  num_folds: 1
  val_split: 0.05

# ============================================================
# Data config (this is now keyed by client_name, not profile)
# ============================================================
data:
  # Train/test datasets generated by Scripts/generate_synth.py
  csv_path: "phlux_lab/data/synthetic/ClientA_centrifugal_dataset_train.csv"
  test_path: "phlux_lab/data/synthetic/ClientA_centrifugal_dataset_test.csv"

  # Schema written alongside the datasets (single source of truth for units)
  schema_path: "phlux_lab/data/synthetic/ClientA_centrifugal_dataset_schema.yaml"

  # Unit handling policy (recommended)
  unit_policy:
    canonical_internal_system: "SI"
    convert_inputs_to_canonical: true
    convert_targets_to_canonical: true
    units_source: "schema_path"

  # IMPORTANT: these must match your CSV column headers (unitless)
  input_features:
    - suction_pressure
    - discharge_pressure
    - delta_pressure
    - speed
    - temperature
    - fluid_density
    - fluid_viscosity
    - pump_power
    - valve_opening
    - sink_pressure

  # Optional engineered features created in the pipeline BEFORE scaling
  derived_features:
    - name: valve_dp
      unit: "bar"          # unit metadata only; conversion handled via schema + unit_policy
      op: "subtract"
      inputs: ["discharge_pressure", "sink_pressure"]
      post_op: "abs"
      clip:
        min: 0.0

  targets:
    - q_liquid
    - hydraulic_wear

  # Optional: noise injection (if your trainer supports it)
  noise:
    enabled: true
    apply_to: "train_only"
    random_seed: 42
    default_mode: "additive"

    features:
      suction_pressure:
        mode: additive
        abs_std: 0.0

      discharge_pressure:
        mode: additive
        abs_std: 0.0

      delta_pressure:
        mode: additive
        abs_std: 0.0

      speed:
        mode: additive
        abs_std: 0.0

      temperature:
        mode: additive
        abs_std: 0.0

      fluid_density:
        mode: additive
        abs_std: 0.0

      fluid_viscosity:
        mode: additive
        abs_std: 0.0

      pump_power:
        mode: additive
        abs_std: 0.0

      sink_pressure:
        mode: additive
        abs_std: 0.0

      valve_opening:
        mode: hybrid
        rel_std: 0.02
        abs_min_std: 0.002
        clip:
          min: 0.0
          max: 1.0

# ============================================================
# Optional second-head settings (no "multitask" wrapper)
# Keep this config available even if youâ€™re not using it today.
# ============================================================
hydraulic_wear_head:
  enabled: true
  loss_weight: 0.2
  probability:
    method: "linear"     # "linear" or "logistic"
    wear_lo: 0.03
    wear_hi: 0.07
